apply plugin: 'groovy'
apply plugin: 'idea'
apply plugin: 'application'
apply plugin: 'maven'
apply plugin: 'java'

sourceCompatibility = 8
version = '3.0.0-SNAPSHOT'
group = "de.stups.slottool"

mainClassName = "de.hhu.stups.plues.modelgenerator.Main"

repositories {
    mavenCentral()
    jcenter()
}

// https://simonharrer.wordpress.com/2013/09/17/building-command-line-apps-with-gradle/
run {
    if (project.hasProperty('args')) {
        args project.args.split('\\s+')
    }
}

dependencies {
    compile 'org.codehaus.groovy:groovy-all:2.4.7'

    compile group: 'commons-cli', name: 'commons-cli', version: '1.3.1'
    compile 'org.jtwig:jtwig-core:5.58'
    compile 'org.hibernate:hibernate-core:5.2.1.Final'
    compile 'org.hibernate:hibernate-c3p0:5.2.1.Final'
    compile 'org.hibernate:hibernate-ehcache:5.2.1.Final'

    runtime group: 'org.xerial', name: 'sqlite-jdbc', version: '3.8.11.2'
    runtime group: 'commons-cli', name: 'commons-cli', version: '1.3.1'

    testRuntime "org.objenesis:objenesis:2.4"
    testCompile "org.spockframework:spock-core:1.0-groovy-2.4"
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.3'
}

task buildStandaloneJar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Model generator for timetable data',
                'Implementation-Version': version,
                'Main-Class': mainClassName
    }
    baseName = project.name + '-standalone'
    from {
        configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) }
    }
    with jar
}
